<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="./jv-datepicker.html">
<link rel="import" href="../neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../paper-styles/paper-styles.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="jv-datepicker-dialog-theme.html">

<dom-module id="jv-datepicker-dialog">
  <template>
    <style include="jv-datepicker-dialog-theme"></style>

    <!-- Main codes starts here -->
    <div class="container layout vertical flex-auto">
      <!-- jv-datepicker's code -->
      <!-- <div class="flex auto" style="background: #9e9e9e;">

      </div> -->
      <jv-datepicker class="flex-auto layout vertical content"
                     first-day-of-week="{{firstDayOfWeek}}"
                     disable-days="{{disableDays}}"
                     date-format="{{dateFormat}}"
                     bind-date="{{_dateOnHold}}"></jv-datepicker>

      <!-- Dialog buttons -->
      <div id="buttonContainer" class="buttons layout horizontal">
        <paper-button dialog-dismiss>cancel</paper-button>
        <paper-button dialog-confirm autofocus on-tap="updateBindDate">ok</paper-button>
      </div>
    </div>
  </template>

  <script>
    (function() {
      Polymer({
        is: 'jv-datepicker-dialog',

        properties: {
          firstDayOfWeek: Number,
          disableDays: Array,
          dateFormat: String,
          bindDate: {
            type: String,
            notify: true
          },
          _dateOnHold: String
        },

        behaviors: [
          Polymer.PaperDialogBehavior,
          Polymer.NeonAnimationRunnerBehavior
        ],

        listeners: {
          'neon-animation-finish': '_onNeonAnimationFinish'
        },
        _renderOpened: function() {
          if (this.withBackdrop) {
            this.backdropElement.open();
          }
          this.playAnimation('entry');
        },
        _renderClosed: function() {
          if (this.withBackdrop) {
            this.backdropElement.close();
          }
          this.playAnimation('exit');
        },
        _onNeonAnimationFinish: function() {
          if (this.opened) {
            this._finishRenderOpened();
          } else {
            this._finishRenderClosed();
          }
        },

        updateBindDate: function(ev) {
          this.set('bindDate', this._dateOnHold);
          this.fire('format-date', {date: this._dateOnHold});
        }
      });
    })();
  </script>
</dom-module>
