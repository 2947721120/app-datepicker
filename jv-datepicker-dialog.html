<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="./jv-datepicker.html">
<link rel="import" href="../neon-animation/neon-animation-runner-behavior.html">
<link rel="import" href="../paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../paper-styles/paper-styles.html">
<link rel="import" href="jv-datepicker-dialog-theme.html">

<dom-module id="jv-datepicker-dialog">
  <template>
    <style include="jv-datepicker-dialog-theme"></style>

    <!-- Main codes starts here -->
    <div class="container layout vertical flex-auto">
      <!-- jv-datepicker's code -->
      <!-- <div class="flex auto" style="background: #9e9e9e;">

      </div> -->
      <jv-datepicker class="flex-auto layout vertical content"
                     first-day-of-week="{{firstDayOfWeek}}"
                     disable-days="{{disableDays}}"
                     date-format="{{dateFormat}}"
                     bind-date="{{bindDate}}"></jv-datepicker>
                     <!-- reset-date="{{resetDate}}"></jv-datepicker> -->

      <!-- Dialog buttons -->
      <div id="buttonContainer" on-tap="_onBtnTap" class="buttons layout horizontal">
        <paper-button dialog-today>today</paper-button>
        <paper-button dialog-dismiss>cancel</paper-button>
        <paper-button on-tap="_formatDate" dialog-confirm autofocus>ok</paper-button>
      </div>
    </div>
  </template>

  <script>
    (function() {
      Polymer({
        is: 'jv-datepicker-dialog',

        properties: {
          firstDayOfWeek: Number,
          disableDays: Array,
          dateFormat: String,
          bindDate: {
            type: String,
            notify: true
          },
          resetDate: Boolean
        },

        behaviors: [
          Polymer.PaperDialogBehavior,
          Polymer.NeonAnimationRunnerBehavior
        ],

        listeners: {
          'neon-animation-finish': '_onNeonAnimationFinish'
        },
        _renderOpened: function() {
          if (this.withBackdrop) {
            this.backdropElement.open();
          }
          this.playAnimation('entry');
        },
        _renderClosed: function() {
          if (this.withBackdrop) {
            this.backdropElement.close();
          }
          this.playAnimation('exit');
        },
        _onNeonAnimationFinish: function() {
          if (this.opened) {
            this._finishRenderOpened();
          } else {
            this._finishRenderClosed();
          }
        },

        _onBtnTap: function(ev) {
          // var target = ev.target;
          // while (target && target !== 'paper-button') {
          //   if (target.hasAttribute) {
          //     if (target.hasAttribute('dialog-today')) {
          //       this._resetDate();
          //       break;
          //     }else if (target.hasAttribute('dialog-dismiss')) {
          //       // console.log(this.resetDate);
          //       if (this.resetDate) {
          //         this._resetDate();
          //         break;
          //       }
          //     }
          //   }
          //   target = target.parentNode;
          // }
        }
      });
    })();
  </script>
</dom-module>
